# MCM 2026 Problem B: Colony Cost Optimization

本项目旨在建立一个多目标优化模型，规划从2050年开始向目标地点（如月球或火星）在未来数十年内运输1亿吨物资的最优策略。核心目标是在**最小化总成本**与**最小化运输时间**之间找到最佳平衡。

---

## 1. 太空电梯成本模型 (`calculate_elevator_cost.py`)

本部分详细介绍了如何计算**方案A：太空电梯 + 月球拖船**的运输总成本。该模型不仅考虑了建设成本，还纳入了运营、能源及后续从地球同步轨道（GEO）到月球的运输成本。

### 1和1. 总成本计算逻辑
对于任意给定的年份和运输量，总成本由以下四部分组成：
$$ \text{Total Cost} = C_{\text{Build}} + C_{\text{Op}} + C_{\text{Elec}} + C_{\text{Tug}} $$

### 1.2 详细组件说明

#### (1) 电梯建设成本 ($C_{\text{Build}}$)
假设建设3座太空电梯，每座成本在 \$100B - \$200B 之间。在优化模型中取平均值。
*   **计算公式**：
    $$ C_{\text{Build}} = N_{\text{Elev}} \times C_{\text{PerUnit}} $$
*   **参数**：
    *   $N_{\text{Elev}} = 3$
    *   $C_{\text{PerUnit}} \approx \$150 \text{ Billion}$

#### (2) 运营成本 ($C_{\text{Op}}$) - 指数衰减
运营成本随技术成熟逐年降低。
*   **初始运营成本**：为建设成本的 1% ($1\% \times C_{\text{Build}}$)。
*   **衰减模型**：每年以 5% 的速率指数衰减。
    $$ C_{\text{Op}}(t) = C_{\text{Op,Initial}} \times e^{-0.05 \times (t - 2050)} $$

#### (3) 电力成本 ($C_{\text{Elec}}$) - 物理积分推导
基于将货物从地球表面提升至 GEO (35,786 km) 所需的重力势能与克服离心力的做功差。
*   **等效重力加速度 ($g_{\text{avg}}$)**：通过积分计算随高度变化的净加速度。
    $$ g_{\text{avg}} = \frac{1}{H} \int_{0}^{H} \left( \frac{G M_E}{(R_E+h)^2} - \omega^2(R_E+h) \right) dh $$
*   **单位能耗成本**：
    $$ \text{Cost}_{\text{Elec/kg}} = \frac{g_{\text{avg}} \times H}{\eta} \times P_{\text{Elec}} $$
    *   $\eta = 0.8$ (能量转换效率 80%)
    *   $P_{\text{Elec}} = \$0.15/\text{kWh}$ (工业电价)

#### (4) 月球拖船成本 ($C_{\text{Tug}}$) - 包含动态复用
负责将货物从太空电梯顶点（Apex Anchor）转运至月球。
*   **总成本**：(拖船制造成本 / 复用次数) + 燃料成本
*   **拖船制造成本** ($C_{\text{TugBuild}}$)：
    *   初始为 \$50M，按每年 7% 指数衰减。
*   **动态复用次数 ($N(t)$)**：
    *   从2050年的10次，按对数模型增长至2100年的100次。
    *   $$ N(t) = 10 + 90 \times \frac{\ln(1 + (t-2050))}{\ln(51)} $$
*   **燃料消耗** (齐奥尔科夫斯基方程)：
    *   $$ m_{\text{fuel}} = m_{\text{payload}} \times (e^{\Delta v / v_e} - 1) $$
    *   $\Delta v = 1640 \text{ m/s}$ (Apex到月球的低能耗转移)
    *   $I_{sp} = 450 \text{ s}$ (液氢液氧发动机)

---

## 2. 火箭发射成本模型 (`calculate_rocket_cost.py`)

本部分介绍了**方案B：重型火箭直运**的成本计算。采用自适应预测模型，动态估算未来的每公斤发射成本。

### 2.1 总成本公式
单次发射的总成本计算如下：
$$ \text{Cost} = M_{\text{Load}} \times \left[ \frac{C_{\text{Mfg}}(t)}{N(t)} + R_{\text{Prop}} \times (0.3 P_{\text{Fuel}}(t) + 0.7 P_{\text{Ox}}) + 0.01 C_{\text{Mfg}}(t) \right] $$

### 2.2 详细组件说明

*   **$C_{\text{Mfg}}(t)$ (制造成本)**：
    *   **计算脚本**：`predict_launch_cost.py`
    *   **算法原理**：
        1.  **数据清洗**：加载 `cost-space-launches-low-earth-orbit.csv`，加权筛选出 **2010年后** 的 **重型火箭 (Heavy Class)** 数据（如 Falcon Heavy），以反映最新的可回收技术水平。
        2.  **分阶段预测**：
            *   **指数衰减期 (<2050)**：拟合公式 $C(t) = (C_0 - C_{\text{floor}})e^{-\lambda t} + C_{\text{floor}}$，模拟初始技术的快速迭代与成本下降。
            *   **平滑过渡期 (2050-2080)**：使用余弦S型曲线（Cosine Transition）将衰减曲线平滑导向长期稳态，避免突变。
            *   **稳态平台期 (>2080)**：成本稳定在物理底线（约 \$150/kg）附近，叠加微小的多周期正弦波动（±5%），模拟成熟市场的自然价格浮动。
*   **$N(t)$ (复用次数)**：
    *   **动态增长模型**：与拖船模型一致，复用次数随时间从 10 次增长到 100 次（2050-2100年）。这极大降低了平摊的制造成本。
    *   $$ N(t) = 10 + 90 \times \frac{\ln(1 + (t-2050))}{\ln(51)} $$
*   **$P_{\text{Fuel}}(t)$ (燃料价格)**：
    *   **计算脚本**：`predict_fuel_price.py`
    *   **算法原理**：
        1.  **历史训练**：基于 `jet_fuel.xlsx` (2005-2025) 数据训练线性回归模型，并提取残差的标准差作为波动率。
        2.  **情景构建 (Scenario-based) (2050+)**：
            *   **基准设定**：考虑到长期资源约束，2050年的基准价格设定为历史均值的 **2.5倍**。
            *   **趋势叠加**：包含极缓慢的长期增长趋势（$<\$1.0/50\text{yrs}$）以模拟通胀。
            *   **周期震荡**：叠加 **10年周期** 的正弦波（振幅 $\approx 0.2$）及随机微扰动，模拟宏观经济周期对能源价格的影响。
        3.  **过渡融合 (2026-2050)**：采用线性插值算法，将当前的历史趋势平滑过渡到2050年的设定情景，确保预测曲线连续无断点。
*   **其他参数**：
    *   $R_{\text{Prop}} = 0.91$：推进剂占火箭总质量的比例（结构系数）。
    *   $P_{\text{Ox}} = \$0.15/\text{kg}$：氧化剂成本（常数）。
    *   维护系数 = 0.01（1%的制造成本用于每次维护）。

---

### 2.3 火箭事故与风险模型 (`predict_rocket_accident.py`)

为了使成本和时间预估更接近现实，我们建立了一个基于历史数据的火箭事故预测模型，并将其引入成本计算。

#### (1) 事故率预测模型
*   **计算脚本**：`predict_rocket_accident.py`
*   **算法原理**：
    1.  **静态贝叶斯推断 (Static Bayesian Inference)**：
        *   使用 `Space_Corrected.csv` 中最近20年的发射数据。
        *   先验分布（Prior）：Beta(2, 200)，假设基础故障率约为 1%（基于民航与成熟航天平均水平的先验知识）。
        *   后验分布（Posterior）：结合历史数据更新故障率 $\theta$。
    2.  **技术成熟度衰减 (Technology Decay)**：
        *   假设随着技术进步，事故率每年以 1% 的速度衰减。
        *   $$ P_{\text{failure}}(t) = \theta_{\text{base}} \times (1 - 0.01)^{(t - 2024)} $$
        *   这模拟了航天系统可靠性的长期提升趋势。

#### (2) 风险与损耗对成本的影响 (`Effective Cost`)
当考虑事故风险时，单次发射的标称成本不变，但**有效单位成本**增加。
*   **有效荷载**：如果故障率为 $P$，则每次发射平均只有 $(1-P)$ 的货物成功送达。
*   **风险调整后成本**：
    $$ \text{Cost}_{\text{Effective}} = \frac{\text{Cost}_{\text{Nominal}}}{1 - P_{\text{failure}}(t)} $$
*   这意味着为了确保单位质量的货物送达，我们必须支付额外的潜在发射费用来覆盖失败的概率。

#### (3) 风险对时间的影响 (`Time Extension`)
在固定发射日频（如10次/天）的限制下，事故不仅仅意味着金钱损失，还意味着**时间损失**。
*   **名义运力**：$C_{\text{Nominal}} = N_{\text{Launches}} \times \text{Payload}$
*   **有效运力**：$C_{\text{Effective}} = C_{\text{Nominal}} \times (1 - P_{\text{failure}}(t))$
*   由于有效运力下降，为了完成同样的 $10^8$ 吨运输任务，所需的总发射次数增加，从而导致**项目总工期延长**。

---

## 3. 多目标优化模型 (`optimization_model.py`)

### 3.1 优化目标
我们面临的是一个典型的多目标优化问题（Pareto Optimization）：
1.  **最小化总成本 (Minimize Cost)**：寻找最经济的运输组合。
2.  **最小化总时间 (Minimize Time)**：尽早完成1亿吨物资运输。

### 3.2 约束条件
*   **总任务量**：必须完成 $10^8$ 吨（100 Million Tons）的运输。
*   **火箭运力约束**：最大发射频率限制为 **10次/天**（受限于发射场周转、空域管制等）。
*   **电梯运力约束**：3座电梯，每座年运力上限 179,000 吨（物理与安全限制）。

### 3.3 算法选择：NSGA-II
我们选择了 **NSGA-II (Non-dominated Sorting Genetic Algorithm II)**，原因如下：
*   **多目标特性**：成本和时间通常是矛盾的（火箭快但贵，电梯慢但便宜），NSGA-II 能直接生成 Pareto 前沿（Pareto Front），展示一系列最优的权衡解，而非单一解。
*   **非线性与动态性**：简单的线性规划难以处理随年变化的指数衰减成本和复杂的阶梯式运力逻辑。

### 3.4 结果亮点 (`optimization_results_nsga2.csv`)
模型成功找到了多种策略，体现了明显的权衡关系：
1.  **极速策略**：
    *   **方法**：火箭满负荷运行（接近10次/天），电梯辅助。
    *   **结果**：仅需 **约92年** 完成任务，但成本高达 **\$1200+ Billion**。
    *   **适用场景**：紧急战略需求，不计成本。
2.  **经济策略**：
    *   **方法**：极少使用火箭，主要依赖电梯的廉价运力，战线拉长。
    *   **结果**：耗时 **约184年**，但成本降至 **\$1016 Billion**。
    *   **适用场景**：长期和平建设，预算有限。
3.  **平衡策略**：
    *   Pareto 前沿的中段方案，提供了合理的折中选择。

通过此模型，决策者可以根据当前的财政状况和战略紧迫性，在 Pareto 曲线上灵活选择最合适的实施方案。
